define(["backbone","models/Font","collections/Weights"],function(e,t,n){var r=e.Collection.extend({model:t,comparator:"order",url:"fonts.php",initialize:function(){this.on("destroy change:status",this.sync,this)},fetch:function(){$.getJSON(this.url,_.bind(this.setFonts,this))},sync:function(){console.log("--------- data saved: ----------"+(new Date).getTime()),$.ajax({type:"POST",url:"fonts.php",data:{action:"updateData",data:JSON.stringify(this)},success:function(e){setTimeout(function(){$("#saving").removeClass("active")},200)}}),$("#saving").addClass("active")},updatePositions:function(e){_.each(e,_.bind(function(e){var t=this.findWhere({hash:e.hash});t.set("order",e.position)},this))},setFonts:function(e){$.each(e,_.bind(function(e,t){var n=this.add({name:t.name,hash:t.hash,defContent:t.defContent,defSize:t.defSize,defHeight:t.defHeight,defWeight:t.defWeight,buypage:t.buypage,heightRatio:t.defHeight/t.defSize,order:t.order,def:t.def,status:t.status});n.get("weights").add(t.weights)},this)),console.log("Fonts"),console.log(this),console.log("- - - - - - - - - - - - - - - ")}});return r});